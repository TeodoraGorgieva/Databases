1) 
CREATE TRIGGER TR_SAVETALK
AFTER DELETE ON CUSTOMER
FOR EACH ROW
WHEN NEW.id IS NOT NULL
BEGIN
    UPDATE TALK
    SET SSN_COSTUMER=OLD.SSN_COSTUMER
    WHERE TALK.SSN_CUSTOMER = OLD.SSN_CUSTOMER
END;

2)
insert into Agent_Seller(SSN,TOTALNUMBEROFCALLS)
values (666666666, 2), (123456789, 3), (101010101, 2)

CREATE TRIGGER TR_NUMBERTALKS
AFTER INSERT ON TALK
FOR EACH ROW
WHEN NEW.SSN_SELLER IS NOT NULL
BEGIN
    UPDATE AGENT_SELLER
    SET TOTALNUMBEROFCALLS=TOTALNUMBEROFCALLS+1
    WHERE NEW.SSN_SELLER=OLD.SSN
END;

3) 
INSERT INTO STORE(ID,NAME,ADDRESS,STOCKQUANTITY)
values (1, 'Neptun', 'lindenska 1,Skopje', 2)

INSERT INTO STORE(ID,NAME,ADDRESS,STOCKQUANTITY)
values (2, 'Setec', 'Partizanska 2,Bitola', 15)

INSERT INTO STORE(ID,NAME,ADDRESS,STOCKQUANTITY)
values (3, 'Anhoch', 'Marshal Tito 5,Struga', 30)

a) 
CREATE TRIGGER TR_QUANTITY
AFTER UPDATE OF COUNT ON STOCK
FOR EACH ROW
WHEN NEW.STOCKQUNATITY IS NOT NULL
BEGIN
    UPDATE STORE
    SET STOCKQUANTITY=STOCKQUANTITY - OLD.COUNT + NEW.COUNT
    WHERE ID = NEW.ID
END;

b)
CREATE TRIGGER TR_PRODUCT
AFTER INSERT STOCK
FOR EACH ROW
WHEN NEW.ID IS NOT NULL
BEGIN
    UPDATE STORE
    SET STOCKQUANTITY=STOCKQUANTITY+NEW.COUNT
    WHERE ID=NEW.ID
END; 

c)
CREATE TRIGGER TR_PRODUCT2
AFTER DELETE OF CODE ON STOCK
FOR EACH ROW
WHEN NEW.ID IS NOT NULL
BEGIN
    UPDATE STORE
    SET STOCKQUANTITY=STOCKQUANTITY-OLD.COUNT
    WHERE ID=NEW.ID
END;

4)

CREATE TRIGGER TR_4A
AFTER UPDATE OF COUNT ON STOCK
FOR EACH ROW
WHEN OLD.STORE_ID=NEW.STORE_ID
BEGIN
    UPDATE STORE
    SET TOTALGOODSPRICE = TOTALGOODSPRICE 
	- OLD.COUNT*P.PRICE
        + NEW.COUNT*P.PRICE
    FROM PRODUCT P
    WHERE Where new.id =id and P.code=new.code

CREATE TRIGGER TR_4B
AFTER INSERT ON STOCK
FOR EACH ROW
BEGIN
    UPDATE STORE
    SET TOTALGOODSPRICE = TOTALGOODSPRICE 
        + NEW.COUNT*P.PRICE
    FROM PRODUCT P
    WHERE STORE_ID = NEW.STORE_ID AND P.CODE=NEW.CODE
CREATE TRIGGER TR_4C
AFTER DELETE ON STOCK
FOR EACH ROW
BEGIN
    UPDATE STORE
    SET TOTALGOODSPRICE = TOTALGOODSPRICE - OLD.COUNT*P.PRICE
    FROM PRODUCT P
    WHERE OLD.STORE_ID = STORE_ID AND P.CODE=OLD.CODE

CREATE TRIGGER TR_4D
AFTER UPDATE OF PRICE ON PRODUCT
FOR EACH ROW
BEGIN
    UPDATE STORE
    SET TOTALGOODSPRICE = TOTALGOODSPRICE 
        - OLD.PRICE*P.PRICE 
        + NEW.PRICE*P.PRICE
    WHERE OLD.STORE_ID = STORE_ID AND P.CODE=NEW.CODE

